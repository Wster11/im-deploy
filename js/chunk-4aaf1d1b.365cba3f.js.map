{"version":3,"sources":["webpack:///./src/pages/Login/index.vue?acd6","webpack:///./src/pages/Login/index.vue","webpack:///./src/pages/Login/index.vue?301a","webpack:///./node_modules/vant/es/form/style/index.mjs","webpack:///./node_modules/vant/es/form/Form.mjs","webpack:///./node_modules/vant/es/form/index.mjs","webpack:///./src/pages/Login/index.vue?d2f9"],"names":["_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","class","_hoisted_2","_createElementVNode","_hoisted_3","style","render","_ctx","_cache","$props","$setup","$data","$options","_component_Field","_resolveComponent","_component_CellGroup","_component_Button","_component_Form","_openBlock","_createElementBlock","_createVNode","onSubmit","login","default","_withCtx","inset","modelValue","username","$event","name","label","placeholder","rules","required","message","password","type","_","loading","round","block","_createTextVNode","onClick","args","toRegister","Login","Vue","constructor","setup","store","useStore","ref","router","useRouter","opt","value","state","IM","connect","open","user","accessToken","pwd","then","res","console","log","catch","e","errInfo","data","JSON","parse","error_description","ERROR_CODE","invalidPassword","_Toast","userNotFound","finally","params","push","__decorate","Options","components","Form","_Form","Field","_Field","CellGroup","_CellGroup","Button","_Button","__exports__","bem","create","formProps","colon","Boolean","disabled","readonly","showError","labelWidth","labelAlign","String","inputAlign","scrollToError","validateFirst","submitOnEnter","showErrorMessage","errorMessageAlign","validateTrigger","Array","stdin_default","props","emits","emit","slots","children","linkChildren","getFieldsByNames","names","filter","field","includes","validateSeq","Promise","resolve","reject","errors","fields","reduce","promise","length","validate","error","validateAll","all","map","item","validateField","name2","matched","find","resetValidation","forEach","getValidationStatus","form","scrollToField","options","some","$el","scrollIntoView","getValues","formValue","submit","values","event","_a","call"],"mappings":"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","file":"js/chunk-4aaf1d1b.365cba3f.js","sourcesContent":["import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-4bd76f7c\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"loginWrap\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"wel\" }, \"VolcanO\", -1))\nconst _hoisted_3 = { style: {\"margin\":\"16px\"} }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Field = _resolveComponent(\"Field\")!\n  const _component_CellGroup = _resolveComponent(\"CellGroup\")!\n  const _component_Button = _resolveComponent(\"Button\")!\n  const _component_Form = _resolveComponent(\"Form\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _hoisted_2,\n    _createVNode(_component_Form, {\n      onSubmit: _ctx.login.onSubmit\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_CellGroup, { inset: \"\" }, {\n          default: _withCtx(() => [\n            _createVNode(_component_Field, {\n              modelValue: _ctx.login.username,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.login.username) = $event)),\n              name: \"user\",\n              label: \"用户名\",\n              placeholder: \"用户名\",\n              rules: [{ required: true, message: '请填写用户名' }]\n            }, null, 8, [\"modelValue\"]),\n            _createVNode(_component_Field, {\n              modelValue: _ctx.login.password,\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.login.password) = $event)),\n              type: \"password\",\n              name: \"pwd\",\n              label: \"Token\",\n              placeholder: \"Token\",\n              rules: [{ required: true, message: '请填写Token' }]\n            }, null, 8, [\"modelValue\"])\n          ]),\n          _: 1\n        }),\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createVNode(_component_Button, {\n            loading: _ctx.login.loading,\n            round: \"\",\n            block: \"\",\n            type: \"primary\",\n            \"native-type\": \"submit\"\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(\" 登录 \")\n            ]),\n            _: 1\n          }, 8, [\"loading\"])\n        ])\n      ]),\n      _: 1\n    }, 8, [\"onSubmit\"]),\n    _createElementVNode(\"div\", {\n      class: \"toRegister\",\n      onClick: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.login.toRegister && _ctx.login.toRegister(...args)))\n    }, \"没有账号？去注册\")\n  ]))\n}","\nimport { Options, Vue, setup } from \"vue-class-component\";\nimport { Form, Field, CellGroup, Button, Toast } from \"vant\";\nimport { ref } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\nimport { ERROR_CODE } from \"@/const/errorCode\";\nimport { AllState } from \"../../store\";\n\ninterface LoginFormParams {\n  user: string;\n  pwd: string;\n  success?: () => void;\n  error?: () => void;\n}\n\n@Options({\n  components: {\n    Form,\n    Field,\n    CellGroup,\n    Button\n  }\n})\nexport default class Login extends Vue {\n  login = setup(() => {\n    const store = useStore<AllState>();\n    const username = ref<string>(\"\");\n    const password = ref<string>(\"\");\n    const router = useRouter();\n\n    let loading = ref<boolean>(false);\n\n    const login = (opt: any) => {\n      // 登录服务器\n      loading.value = true;\n      store.state.IM.connect\n        // .open(opt)\n        .open({\n          user: opt.user,\n          accessToken: opt.pwd\n        })\n        .then((res) => {\n          console.log(res, 'login result')\n          // Toast(\"登录成功\");\n          // window.localStorage.setItem(\"uid\", username.value);\n          // window.localStorage.setItem(\"token\", res.accessToken);\n          // router.push(\"/chat\");\n        })\n        .catch((e) => {\n          let errInfo: any = {};\n          if (e.data.data) {\n            errInfo = JSON.parse(e.data.data);\n          }\n          if (errInfo.error_description === ERROR_CODE.invalidPassword) {\n            Toast(\"用户名或密码错误\");\n          } else if (errInfo.error_description === ERROR_CODE.userNotFound) {\n            Toast(\"用户不存在\");\n          } else {\n            Toast(\"登录失败\");\n          }\n        })\n        .finally(() => {\n          loading.value = false;\n        });\n    };\n\n    const onSubmit = (params: LoginFormParams): void => {\n      login(params);\n    };\n\n    const toRegister = (): void => {\n      router.push(\"/register\");\n    };\n\n    return {\n      username,\n      password,\n      loading,\n      toRegister,\n      onSubmit\n    };\n  });\n}\n","import { render } from \"./index.vue?vue&type=template&id=4bd76f7c&scoped=true&ts=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=4bd76f7c&scoped=true&lang=less\"\n\nimport exportComponent from \"/Users/zhaoliang/Desktop/vue3-webim/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4bd76f7c\"]])\n\nexport default __exports__","import \"../../style/base.css\";\n","import { createVNode as _createVNode } from \"vue\";\nimport { defineComponent } from \"vue\";\nimport { FORM_KEY, truthProp, numericProp, preventDefault, createNamespace } from \"../utils/index.mjs\";\nimport { useChildren } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nconst [name, bem] = createNamespace(\"form\");\nconst formProps = {\n  colon: Boolean,\n  disabled: Boolean,\n  readonly: Boolean,\n  showError: Boolean,\n  labelWidth: numericProp,\n  labelAlign: String,\n  inputAlign: String,\n  scrollToError: Boolean,\n  validateFirst: Boolean,\n  submitOnEnter: truthProp,\n  showErrorMessage: truthProp,\n  errorMessageAlign: String,\n  validateTrigger: {\n    type: [String, Array],\n    default: \"onBlur\"\n  }\n};\nvar stdin_default = defineComponent({\n  name,\n  props: formProps,\n  emits: [\"submit\", \"failed\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const {\n      children,\n      linkChildren\n    } = useChildren(FORM_KEY);\n    const getFieldsByNames = (names) => {\n      if (names) {\n        return children.filter((field) => names.includes(field.name));\n      }\n      return children;\n    };\n    const validateSeq = (names) => new Promise((resolve, reject) => {\n      const errors = [];\n      const fields = getFieldsByNames(names);\n      fields.reduce((promise, field) => promise.then(() => {\n        if (!errors.length) {\n          return field.validate().then((error) => {\n            if (error) {\n              errors.push(error);\n            }\n          });\n        }\n      }), Promise.resolve()).then(() => {\n        if (errors.length) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      });\n    });\n    const validateAll = (names) => new Promise((resolve, reject) => {\n      const fields = getFieldsByNames(names);\n      Promise.all(fields.map((item) => item.validate())).then((errors) => {\n        errors = errors.filter(Boolean);\n        if (errors.length) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      });\n    });\n    const validateField = (name2) => {\n      const matched = children.find((item) => item.name === name2);\n      if (matched) {\n        return new Promise((resolve, reject) => {\n          matched.validate().then((error) => {\n            if (error) {\n              reject(error);\n            } else {\n              resolve();\n            }\n          });\n        });\n      }\n      return Promise.reject();\n    };\n    const validate = (name2) => {\n      if (typeof name2 === \"string\") {\n        return validateField(name2);\n      }\n      return props.validateFirst ? validateSeq(name2) : validateAll(name2);\n    };\n    const resetValidation = (name2) => {\n      if (typeof name2 === \"string\") {\n        name2 = [name2];\n      }\n      const fields = getFieldsByNames(name2);\n      fields.forEach((item) => {\n        item.resetValidation();\n      });\n    };\n    const getValidationStatus = () => children.reduce((form, field) => {\n      form[field.name] = field.getValidationStatus();\n      return form;\n    }, {});\n    const scrollToField = (name2, options) => {\n      children.some((item) => {\n        if (item.name === name2) {\n          item.$el.scrollIntoView(options);\n          return true;\n        }\n        return false;\n      });\n    };\n    const getValues = () => children.reduce((form, field) => {\n      form[field.name] = field.formValue.value;\n      return form;\n    }, {});\n    const submit = () => {\n      const values = getValues();\n      validate().then(() => emit(\"submit\", values)).catch((errors) => {\n        emit(\"failed\", {\n          values,\n          errors\n        });\n        if (props.scrollToError && errors[0].name) {\n          scrollToField(errors[0].name);\n        }\n      });\n    };\n    const onSubmit = (event) => {\n      preventDefault(event);\n      submit();\n    };\n    linkChildren({\n      props\n    });\n    useExpose({\n      submit,\n      validate,\n      getValues,\n      scrollToField,\n      resetValidation,\n      getValidationStatus\n    });\n    return () => {\n      var _a;\n      return _createVNode(\"form\", {\n        \"class\": bem(),\n        \"onSubmit\": onSubmit\n      }, [(_a = slots.default) == null ? void 0 : _a.call(slots)]);\n    };\n  }\n});\nexport {\n  stdin_default as default\n};\n","import { withInstall } from \"../utils/index.mjs\";\nimport _Form from \"./Form.mjs\";\nconst Form = withInstall(_Form);\nvar stdin_default = Form;\nexport {\n  Form,\n  stdin_default as default\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=4bd76f7c&scoped=true&lang=less\""],"sourceRoot":""}